<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Radiation Monitoring</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Radiation Monitoring Dashboard</h1>
    <div id="graph"></div>

    <script>
        var socket = io.connect("http://" + document.domain + ":" + location.port);
        var data = [{ x: [], y: [], type: "scatter", mode: "lines+markers", name: "Beta Level" }, { x: [], y: [], type: "scatter", mode: "lines+markers", name: "Gamma Level" }];

        var layout = { title: "Radiation Levels (ÂµSv/h)", xaxis: { title: "Time" }, yaxis: { title: "Radiation Level" } };
        Plotly.newPlot("graph", data, layout);

        socket.on("new_data", function(msg) {
            var time = new Date(msg.time);
            var beta = msg.beta;
            var gamma = msg.gamma;

            data[0].x.push(time);
            data[0].y.push(beta);
            data[1].x.push(time);
            data[1].y.push(gamma);

            if (data[0].x.length > 100) {
                data[0].x.shift();
                data[0].y.shift();
                data[1].x.shift();
                data[1].y.shift();
            }

            Plotly.update("graph", { x: [data[0].x, data[1].x], y: [data[0].y, data[1].y] }, {});
        });
    </script>
</body>
</html>
